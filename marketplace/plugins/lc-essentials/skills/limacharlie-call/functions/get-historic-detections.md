# get_historic_detections

Retrieve historical security detections within a time range.

**Note:** This is for searching by time range. Use `get_detection` when you have a specific detection ID.

## CRITICAL: Timestamps in SECONDS

API parameters require Unix epoch in **seconds** (10 digits), NOT milliseconds.

Detection data contains `ts`/`event_time` in milliseconds → **divide by 1000** before using.

## CRITICAL: Calculating Timestamps

**❌ NEVER calculate epoch values manually** - LLMs produce incorrect timestamps (e.g., 2024 instead of 2025).

**✅ ALWAYS use bash:**
```bash
# Last 7 days
start=$(date -d '7 days ago' +%s)
end=$(date +%s)

# Last 24 hours
start=$(date -d '24 hours ago' +%s)
end=$(date +%s)

# Specific date range
start=$(date -d '2025-01-15 00:00:00 UTC' +%s)
end=$(date -d '2025-01-22 00:00:00 UTC' +%s)
```

## Parameters

| Name | Type | Required | Description |
|------|------|----------|-------------|
| oid | UUID | Yes | Organization ID ([Core Concepts](../../../CALLING_API.md#core-concepts)) |
| start | integer | Yes | Start time (Unix epoch **seconds**) |
| end | integer | Yes | End time (Unix epoch **seconds**) |
| sid | UUID | No | Filter by sensor ID |
| cat | string | No | Filter by category (e.g., "malware", "suspicious_process") |
| limit | integer | No | Max results |

## Returns

```json
{
  "detects": [
    {
      "detect_id": "detect-uuid-123",
      "cat": "suspicious_process",
      "detect": {
        "event": {
          "COMMAND_LINE": "powershell.exe -encodedCommand ...",
          "FILE_PATH": "C:\\Windows\\System32\\..."
        },
        "routing": {"sid": "xyz-123", "hostname": "SERVER01"}
      },
      "detect_mtd": {
        "rule_name": "Encoded PowerShell",
        "severity": 8
      }
    }
  ],
  "next_cursor": "cursor-or-empty"
}
```

## Example

```
lc_call_tool(tool_name="get_historic_detections", parameters={
  "oid": "c7e8f940-1234-5678-abcd-1234567890ab",
  "start": 1705761234,
  "end": 1705847634,
  "cat": "suspicious_process",
  "limit": 100
})
```

## Notes

- Detections are generated by D&R rules
- Severity typically ranges 1-10
- Use pagination (cursor) for large result sets
- Related: `get_detection` (single detection by ID), `run_lcql_query`
